<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
<title>The Little Man Computer &#9642; c272</title>
<!--

<meta name="description" content="Emulation for dummies.
">
-->


<meta name="description" content="Emulation for dummies.">
<meta name="keywords" content="nodejs">
<link rel="canonical" href="https://c272.org/posts/the-little-man-computer">
<link rel="shortcut icon" type="image/icon" href="/favicon.ico">






<!-- Twitter Cards -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="The Little Man Computer" />
<meta name="twitter:description" content="Emulation for dummies.
" />
<meta name="twitter:image" content="https://c272.org" />

<!-- Google plus -->
<meta name="author" content="">
<link rel="author" href="">

<!-- Open Graph -->
<meta property="og:locale" content="">
<meta property="og:type" content="article">
<meta property="og:title" content="The Little Man Computer">
<meta property="og:description" content="Emulation for dummies.
">
<meta property="og:url" content="https://c272.org/posts/the-little-man-computer">
<meta property="og:site_name" content="c272">

<!-- Styles -->
<link rel="stylesheet" href="/assets/vendor/normalize-css/normalize.css">
<link rel="stylesheet" href="/assets/css/main.css">


<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Rubik:400,400italic,700,700italic">
<style>
    html {
      font-family: "Rubik", -apple-system, BlinkMacSystemFont, "Helvetica Neue", sans-serif;
    }
</style>



<link rel="stylesheet" href="/assets/css/bf.css">


    </head>

    <body>
        <div class="wrapper" id="blep">
            <header>
    <div class="menu">
      <div class="logo">

        <a href="/">c272</a>
        <object type="image/svg+xml" data="/assets/img/coffeecup.svg" class="logosvg">Your browser does not support svg images</object>
      </div>

        <ul>
            <li><a href="/about">about</a></li>
            <li><a href="/archive">archive</a></li>
        </ul>
    </div>
    <div class="social">
      <ul>
        
        
        
        
        <li>
            <a href="https://github.com/c272" target="_blank" class="smaller">
              <span class="icon-github"></span>
            </a>
        </li>
        
        
        <li>
            <a href="mailto:larry@c272.org" target="_blank">
              <span class="icon-mail_outline"></span>
            </a>
        </li>
        
        
        <li>
            <a href="/feed.xml" target="_blank">
                <span class="icon-rss_feed"></span>
            </a>
        </li>
        
        <li>
            <a href="#" onclick="switchTheme()" title="Switch theme?">
              <span class="icon-invert_colors" id="theme-switcher"></span>
            </a>
        </li>
      </ul>
    </div>
</header>


            

<article class="post">

  
  








<style>
  .the-little-man-computer {
    margin-bottom: 2em;
  }
  .the-little-man-computer::before {
    background-image: url('/assets/img/bitsetbg.jpg');
    background-size: cover;
    -webkit-filter: grayscale(1) brightness(0.5) contrast(0.5);

    content:'';
    position:absolute;
    width: 100%;
    left: 0;
    top: 0;
    z-index: -2;
  }
  .the-little-man-computer::after {
    content:'';
    position:absolute;
    width: 100%;
    left: 0;
    top: 0;

    background-color: rgba(0,100,255,0.8);

    /*mix-blend-mode: darken;
    mix-blend-mode: color-burn;
    mix-blend-mode: hard-light;*/
    mix-blend-mode: overlay;
    z-index: -1;
  }

  .the-little-man-computer-container,
  .the-little-man-computer-container::before,
  .the-little-man-computer-container::after {
    height: 25rem;
  }

  .the-little-man-computer-bleed-container,
  .the-little-man-computer-bleed-container::before,
  .the-little-man-computer-bleed-container::after {
    height: 35rem;
  }

    @media (max-width: 48rem) {
        .the-little-man-computer-container,
        .the-little-man-computer-container::before,
        .the-little-man-computer-container::after{
            height: 20rem;
            margin-bottom: 3rem;
        }
    }
</style>

  

  <!-- Post title (& hero image) container -->
  <div class="post-title-container
  
  the-little-man-computer the-little-man-computer-bleed-container bleed-hero-container
    ">
    <!--Post hero image source-->
    
      
    
    <!-- Post title -->
    <div class="heading-container hero-heading hero-heading-post">
      <h1>
        
          The Little Man Computer
        
      </h1>
    <!-- Post meta -->
      <div class="post-meta">
        <span>29/03/2018</span>
        <!-- 




    

    
    

    

    
    

    
    piątek, 29 marzec 2018

 -->
        <span>
          
              <a href="/tag/nodejs">#nodejs</a>
          
        </span>
      </div>
    </div>
  </div>

    <!-- Post content -->
    <p>Over the past couple of months, apart from writing my book, “You Suck at Programming” <sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup>, I’ve been working on an emulator/interpreter for the famous computer simulation “Little Man Computer”, by Peter Higginson. It was created many years ago to help students learn about how the CPU and memory worked and interacted with each other, and was a great way for me to try and understand some lower level emulation, as it has an instruction set consisting of just nine operations. These operations are:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>ADD – Addition
SUB – Subtraction
DAT – Data Storage
LDA – Load Data
STA – Store Data
HLT – Halt Program
BIZ – Branch if Zero
BRA – Branch Always
BZP – Branch if Zero or Positive
</pre></td></tr></tbody></table></code></pre></div></div>

<p>They all sounded fairly simple to implement, so I went about creating the first prototypes for the interpreter of this program. Initially, I tried to create a dictionary with 99 data spaces to store my data, however this ended up causing a lot of problems for me down the line. I eventually had to scrap the entire idea, and ended up just using a simple two dimensional array. Now that that was sorted, I needed to somehow get a standard data format including data and addresses, and have an interpreter read them properly. Luckily, Little Man Computer is close enough to a real computer that it uses “opcodes”, small (in this case 3 character) strings which tell you which command is being executed, and at what address. So, the format I came up with looked like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>[[00, 901], [01, 105], [02, 902]]
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The 2D array contains in the first position the address of the current memory slot (ascending from 00), and in the second position the opcode of the command. “901” is input, and “902” output, with “1” being addition, and “5” being the address that is added to the accumulator’s current value (which is what the ADD command actually does, but more on the accumulator later). So, by that definition, this program just takes an input, adds the value of address 5 to it, and spits out the answer.</p>

<p>I then realised that I needed some way of storing the value of the accumulator, program counter, and all the other registers within the LMC CPU. So, I just used basic integers. Simple.</p>

<p>The interpreter I wrote has a chain of decoding that it has to complete before it reaches the “execution” part of “fetch, decode, execute”. The fetching has already been done in the form of the two dimensional array, and the decoding is the fun bit. The interpreter loops through each value in the array, checking the memory slot’s second position for the opcode, and one by one executing the commands. If a branch is found to be true, then the interpreter loops through all positions in the two dimensional array until the first position’s value matches the last two characters of the branch (like 804, which would search for address “04” if the value was positive or zero). The code will then continue from that location until a halting operation (HLT).</p>

<p>For this, however, I had to create an essentially entirely new file format called “Little Man Script, or .LMS. I’ve included a compiler in the project that allows you to convert plaintext commands (like “LDA 04” or “STA 99”) into a formatted “.LMS” file which you can run with either the executable file or the raw Javascript.</p>

<p>To see this in action for yourself, and to try writing an assembly script on your own (you can use the provided compiler to convert text files) navigate to my GitHub page by clicking <a href="https://github.com/c272/jLMC">here</a>, and downloading a zip of all the files in the source.</p>

<p>That’s all for now, but I’ll catch up with you soon when the book is nearer to release.</p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p>This book was later renamed to “Programming at Light Speed”. <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

</article>




<aside class="related">

<h2>Related posts</h2>
<ul class="related-posts">





  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  



<p>There are no posts related to this one yet. Check back later!</p>



</aside>





            <footer>
    <span>A blog for weird and wonderful programming topics,</span>
    <span>written by C272</span>
</footer>

        </div>

        <!-- load theme switcher and barefoot footnotes -->

<script type="text/javascript" src="/assets/js/theme.js"></script>

<script type="text/javascript" src="/assets/js/barefoot.js"></script>


        
    </body>
</html>
