<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
<title>Wrappers in C#, and when not to use them. &#9642; c272</title>
<!--

<meta name="description" content="A rant about wrapper dependency hell.
">
-->


<meta name="description" content="A rant about wrapper dependency hell.">
<meta name="keywords" content="nodejs">
<link rel="canonical" href="https://c272.org/posts/wrappers-in-csharp">
<link rel="shortcut icon" type="image/icon" href="/favicon.ico">






<!-- Twitter Cards -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Wrappers in C#, and when not to use them." />
<meta name="twitter:description" content="A rant about wrapper dependency hell.
" />
<meta name="twitter:image" content="https://c272.org" />

<!-- Google plus -->
<meta name="author" content="">
<link rel="author" href="">

<!-- Open Graph -->
<meta property="og:locale" content="">
<meta property="og:type" content="article">
<meta property="og:title" content="Wrappers in C#, and when not to use them.">
<meta property="og:description" content="A rant about wrapper dependency hell.
">
<meta property="og:url" content="https://c272.org/posts/wrappers-in-csharp">
<meta property="og:site_name" content="c272">

<!-- Styles -->
<link rel="stylesheet" href="/assets/vendor/normalize-css/normalize.css">
<link rel="stylesheet" href="/assets/css/main.css">


<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Rubik:400,400italic,700,700italic">
<style>
    html {
      font-family: "Rubik", -apple-system, BlinkMacSystemFont, "Helvetica Neue", sans-serif;
    }
</style>



<link rel="stylesheet" href="/assets/css/bf.css">


    </head>

    <body>
        <div class="wrapper" id="blep">
            <header>
    <div class="menu">
      <div class="logo">

        <a href="/">c272</a>
        <object type="image/svg+xml" data="/assets/img/coffeecup.svg" class="logosvg">Your browser does not support svg images</object>
      </div>

        <ul>
            <li><a href="/about">about</a></li>
            <li><a href="/archive">archive</a></li>
        </ul>
    </div>
    <div class="social">
      <ul>
        
        
        
        
        <li>
            <a href="https://github.com/c272" target="_blank" class="smaller">
              <span class="icon-github"></span>
            </a>
        </li>
        
        
        <li>
            <a href="mailto:larry@c272.org" target="_blank">
              <span class="icon-mail_outline"></span>
            </a>
        </li>
        
        
        <li>
            <a href="/feed.xml" target="_blank">
                <span class="icon-rss_feed"></span>
            </a>
        </li>
        
        <li>
            <a href="#" onclick="switchTheme()" title="Switch theme?">
              <span class="icon-invert_colors" id="theme-switcher"></span>
            </a>
        </li>
      </ul>
    </div>
</header>


            

<article class="post">

  
  








<style>
  .wrappers-in-csharp {
    margin-bottom: 2em;
  }
  .wrappers-in-csharp::before {
    background-image: url('/assets/img/bitsetbg.jpg');
    background-size: cover;
    -webkit-filter: grayscale(1) brightness(0.5) contrast(0.5);

    content:'';
    position:absolute;
    width: 100%;
    left: 0;
    top: 0;
    z-index: -2;
  }
  .wrappers-in-csharp::after {
    content:'';
    position:absolute;
    width: 100%;
    left: 0;
    top: 0;

    background-color: rgba(100,255,0,0.8);

    /*mix-blend-mode: darken;
    mix-blend-mode: color-burn;
    mix-blend-mode: hard-light;*/
    mix-blend-mode: overlay;
    z-index: -1;
  }

  .wrappers-in-csharp-container,
  .wrappers-in-csharp-container::before,
  .wrappers-in-csharp-container::after {
    height: 25rem;
  }

  .wrappers-in-csharp-bleed-container,
  .wrappers-in-csharp-bleed-container::before,
  .wrappers-in-csharp-bleed-container::after {
    height: 35rem;
  }

    @media (max-width: 48rem) {
        .wrappers-in-csharp-container,
        .wrappers-in-csharp-container::before,
        .wrappers-in-csharp-container::after{
            height: 20rem;
            margin-bottom: 3rem;
        }
    }
</style>

  

  <!-- Post title (& hero image) container -->
  <div class="post-title-container
  
  wrappers-in-csharp wrappers-in-csharp-bleed-container bleed-hero-container
    ">
    <!--Post hero image source-->
    
      
    
    <!-- Post title -->
    <div class="heading-container hero-heading hero-heading-post">
      <h1>
        
          Wrappers in C#, and when not to use them.
        
      </h1>
    <!-- Post meta -->
      <div class="post-meta">
        <span>26/05/2018</span>
        <!-- 




    

    
    

    

    
    

    
    niedziela, 26 maj 2018

 -->
        <span>
          
              <a href="/tag/nodejs">#nodejs</a>
          
        </span>
      </div>
    </div>
  </div>

    <!-- Post content -->
    <p class="notice-alert">I no longer agree with this article, but am keeping it here as a reminder. As you can tell, I was a bit frustrated. What I do still agree with, though, is the NodeJS dependency stack is absolute hell.</p>

<p>When working on a project recently, I was required to do some networking to communicate between the C#.NET application I was creating, and a remote online server. Sounds pretty easy, right? Well, I’d been thinking about a couple of solutions, when I remembered an easy networking solution called Socket.IO (which you can check out here). Unfortunately, this program was native to NodeJS, and wasn’t available for a C# application, which sucked.</p>

<p>After a little searching, however, I found a C#.NET wrapper for the program, which could be installed by Nuget in VS2015 natively! It’s a great compatibility fixer, and you can find it on Quobject’s Github page <sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup>. So, I set to work creating the client in C#, and the server in NodeJS. The syntax for both of them is remarkably similar, and after some tweaking from the Github example scripts, I managed to get this:</p>

<p><img src="/uploads/wrapperArticleSS.png" alt="pic" /></p>

<p>Obviously the server address is censored, but the logic of the script should still be pretty clear.
It connects to the server, and then sends an “<code class="language-plaintext highlighter-rouge">isLatestVersion</code>” request to the server, along with the current version number of the program, and waits for a response. When it gets one back, it checks whether the value is false, and if it is, starts the update program.</p>

<p>However, there was a caveat with this system. The windows form that handled the updating used a third party Node package designed for use with Socket.IO, called “delivery”. It was made by primarily the same developers, and based on the newest version, and was labelled as “fully compatible” with C#. This is where the lesson comes in:</p>

<p>Don’t use wrappers if you are going to use third party packages.</p>

<p>It’s one or the other, is the point. Because, as soon as that happened, everything completely exploded <sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup>. Blunt, but true. When using the package, I first noticed that it used an automatically executing asynchronous function, which immediately raised red flags, as C#’s wrapper doesn’t like that at all, from previous testing. When running it, sure enough, it spat out that the variable “window” wasn’t assigned in the async function call, as it was coming from a C# source, which doesn’t have a window property. This kind of left me in a bad place, so I removed the asynchronous function and window variable from the package entirely, and used C#’s native systems instead.</p>

<p>This only created more problems, as the incompatibilities that I couldn’t see before were now unearthed, grisly and disgusting, for all the world to see. First, an error involving the “Delivery()” constructor used in my actual native NodeJS script broke, which was likely due to my meddling with the window function, however was fixed by a thorough crawl through the documentation and package source files, and a quick change in the script from using “var delivery = new Delivery()” to “var delivery = delivery.connect(ip, apic, {reconnect:true/false})”. Much uglier, but still functional. Then, an error surfaced to do with MIME, one of the package’s dependencies, and entirely unrelated to my project. At this point, I was getting a little tired, but soldiered on to try and fix the error.</p>

<p>After some research into the error code I received, it appeared that <strong>another package entirely, Knox,</strong> was causing this error, one of MIME’s dependencies! This is when I learned my lesson. When a third party package is ported over to another language, all it’s dependencies have to be as well. This creates an inconceivable number of errors if they aren’t all properly ported with identical syntax, and digs a very deep rabbit hole from which it’s nearly impossible to crawl out of.</p>

<p>I eventually did fix the cross compatibility issue, but only by contacting the developer via. a pull request and actually changing the code of the package itself to support a lower MIME version with the command! In my opinion, that was more stress than using a more complicated networking solution, but having little errors due to native compatibility.</p>

<p>I’m never using a wrapper and third party tools together ever again.
Thanks, and adieu.</p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p>Do not use this software, it is long outdated now and very deprecated. <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2" role="doc-endnote">
      <p>Maybe this wasn’t the wording in the original article… <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

</article>




<aside class="related">

<h2>Related posts</h2>
<ul class="related-posts">





  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  



<p>There are no posts related to this one yet. Check back later!</p>



</aside>





            <footer>
    <span>A blog for weird and wonderful programming topics,</span>
    <span>written by C272</span>
</footer>

        </div>

        <!-- load theme switcher and barefoot footnotes -->

<script type="text/javascript" src="/assets/js/theme.js"></script>

<script type="text/javascript" src="/assets/js/barefoot.js"></script>


        
    </body>
</html>
